<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نموذج تقييم مركبة مستردّة | Repossessed Vehicle Evaluation Form</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <!-- html2canvas & jsPDF for PDF export -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <!-- SheetJS for Excel export -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="form-header">
            <div class="logo-placeholder">
                <i class="fas fa-car"></i>
            </div>
            <div class="header-titles">
                <h1>نموذج تقييم مركبة مستردّة</h1>
                <h2>Repossessed Vehicle Evaluation Form</h2>
            </div>
            <div class="form-number">
                <span>رقم النموذج:</span>
                <input type="text" id="formNumber" placeholder="____">
            </div>
        </header>

        <!-- Form Content -->
        <form id="vehicleEvaluationForm">
            <!-- Section 1: Basic Information -->
            <section class="form-section">
                <div class="section-header">
                    <span class="section-number">أولاً</span>
                    <h3>البيانات الأساسية <span class="en-title">Basic Information</span></h3>
                </div>
                <div class="section-content">
                    <div class="info-grid">
                        <div class="info-row">
                            <div class="info-item">
                                <label>رقم العقد / Contract No.</label>
                                <input type="text" name="contractNo" id="contractNo">
                            </div>
                            <div class="info-item">
                                <label>رقم الهيكل (VIN)</label>
                                <input type="text" name="vin" id="vin" maxlength="17">
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="info-item">
                                <label>اسم العميل / Customer Name</label>
                                <input type="text" name="customerName" id="customerName">
                            </div>
                            <div class="info-item">
                                <label>قراءة العداد / Odometer</label>
                                <input type="number" name="odometer" id="odometer" placeholder="كم">
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="info-item">
                                <label>نوع المركبة / Make</label>
                                <input type="text" name="make" id="make">
                            </div>
                            <div class="info-item">
                                <label>لون المركبة / Color</label>
                                <input type="text" name="color" id="color">
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="info-item">
                                <label>الموديل / Model</label>
                                <input type="text" name="model" id="model">
                            </div>
                            <div class="info-item">
                                <label>تاريخ الاسترداد / Repo Date</label>
                                <input type="date" name="repoDate" id="repoDate">
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="info-item">
                                <label>سنة الصنع / Year</label>
                                <input type="number" name="year" id="year" min="1990" max="2030">
                            </div>
                            <div class="info-item">
                                <label>موقع الاسترداد / Repo Location</label>
                                <input type="text" name="repoLocation" id="repoLocation">
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="info-item">
                                <label>رقم اللوحة / Plate No.</label>
                                <input type="text" name="plateNo" id="plateNo">
                            </div>
                            <div class="info-item">
                                <label>نوع الوقود / Fuel Type</label>
                                <select name="fuelType" id="fuelType">
                                    <option value="">اختر...</option>
                                    <option value="petrol">بنزين / Petrol</option>
                                    <option value="diesel">ديزل / Diesel</option>
                                    <option value="hybrid">هجين / Hybrid</option>
                                    <option value="electric">كهربائي / Electric</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Technical Evaluation -->
            <section class="form-section">
                <div class="section-header">
                    <span class="section-number">ثانياً</span>
                    <h3>تقييم الحالة الفنية <span class="en-title">Technical Condition Evaluation</span></h3>
                </div>
                <div class="section-content">
                    <table class="evaluation-table">
                        <thead>
                            <tr>
                                <th class="item-col">البند / Item</th>
                                <th class="rating-col">ممتاز<br><span class="en-text">Excellent</span></th>
                                <th class="rating-col">جيد<br><span class="en-text">Good</span></th>
                                <th class="rating-col">ضعيف<br><span class="en-text">Poor</span></th>
                                <th class="notes-col">ملاحظات / Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="item-name">الهيكل الخارجي / Body</td>
                                <td class="rating-cell"><input type="radio" name="body" value="excellent"></td>
                                <td class="rating-cell"><input type="radio" name="body" value="good"></td>
                                <td class="rating-cell"><input type="radio" name="body" value="poor"></td>
                                <td class="notes-cell"><input type="text" name="bodyNotes"></td>
                            </tr>
                            <tr>
                                <td class="item-name">الإطارات / Tires</td>
                                <td class="rating-cell"><input type="radio" name="tires" value="excellent"></td>
                                <td class="rating-cell"><input type="radio" name="tires" value="good"></td>
                                <td class="rating-cell"><input type="radio" name="tires" value="poor"></td>
                                <td class="notes-cell"><input type="text" name="tiresNotes"></td>
                            </tr>
                            <tr>
                                <td class="item-name">الإضاءة / Lights</td>
                                <td class="rating-cell"><input type="radio" name="lights" value="excellent"></td>
                                <td class="rating-cell"><input type="radio" name="lights" value="good"></td>
                                <td class="rating-cell"><input type="radio" name="lights" value="poor"></td>
                                <td class="notes-cell"><input type="text" name="lightsNotes"></td>
                            </tr>
                            <tr>
                                <td class="item-name">المقاعد والتنجيد / Seats & Upholstery</td>
                                <td class="rating-cell"><input type="radio" name="seats" value="excellent"></td>
                                <td class="rating-cell"><input type="radio" name="seats" value="good"></td>
                                <td class="rating-cell"><input type="radio" name="seats" value="poor"></td>
                                <td class="notes-cell"><input type="text" name="seatsNotes"></td>
                            </tr>
                            <tr>
                                <td class="item-name">الزجاج / Glass</td>
                                <td class="rating-cell"><input type="radio" name="glass" value="excellent"></td>
                                <td class="rating-cell"><input type="radio" name="glass" value="good"></td>
                                <td class="rating-cell"><input type="radio" name="glass" value="poor"></td>
                                <td class="notes-cell"><input type="text" name="glassNotes"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 3: Damage Assessment -->
            <section class="form-section">
                <div class="section-header">
                    <span class="section-number">ثالثاً</span>
                    <h3>تقييم الأضرار <span class="en-title">Damage Assessment</span></h3>
                </div>
                <div class="section-content">
                    <div class="damage-grid">
                        <div class="damage-item">
                            <label>
                                <input type="checkbox" name="damages" value="scratches">
                                <span>خدوش / Scratches</span>
                            </label>
                        </div>
                        <div class="damage-item">
                            <label>
                                <input type="checkbox" name="damages" value="dents">
                                <span>انبعاجات / Dents</span>
                            </label>
                        </div>
                        <div class="damage-item">
                            <label>
                                <input type="checkbox" name="damages" value="rust">
                                <span>صدأ / Rust</span>
                            </label>
                        </div>
                        <div class="damage-item">
                            <label>
                                <input type="checkbox" name="damages" value="cracked_glass">
                                <span>زجاج متصدع / Cracked Glass</span>
                            </label>
                        </div>
                        <div class="damage-item">
                            <label>
                                <input type="checkbox" name="damages" value="missing_parts">
                                <span>أجزاء مفقودة / Missing Parts</span>
                            </label>
                        </div>
                        <div class="damage-item">
                            <label>
                                <input type="checkbox" name="damages" value="accident_damage">
                                <span>أضرار حادث / Accident Damage</span>
                            </label>
                        </div>
                    </div>
                    <div class="damage-details">
                        <label>تفاصيل الأضرار / Damage Details:</label>
                        <textarea name="damageDetails" id="damageDetails" rows="4" placeholder="اذكر تفاصيل الأضرار الموجودة..."></textarea>
                    </div>
                </div>
            </section>

            <!-- Section 4: Accessories & Equipment -->
            <section class="form-section">
                <div class="section-header">
                    <span class="section-number">رابعاً</span>
                    <h3>الملحقات والمعدات <span class="en-title">Accessories & Equipment</span></h3>
                </div>
                <div class="section-content">
                    <div class="accessories-grid">
                        <div class="accessory-item">
                            <label>
                                <input type="checkbox" name="accessories" value="spare_tire">
                                <span>إطار احتياطي / Spare Tire</span>
                            </label>
                        </div>
                        <div class="accessory-item">
                            <label>
                                <input type="checkbox" name="accessories" value="jack">
                                <span>رافعة / Jack</span>
                            </label>
                        </div>
                        <div class="accessory-item">
                            <label>
                                <input type="checkbox" name="accessories" value="tools">
                                <span>عدة أدوات / Tool Kit</span>
                            </label>
                        </div>
                        <div class="accessory-item">
                            <label>
                                <input type="checkbox" name="accessories" value="first_aid">
                                <span>حقيبة إسعاف / First Aid Kit</span>
                            </label>
                        </div>
                        <div class="accessory-item">
                            <label>
                                <input type="checkbox" name="accessories" value="fire_extinguisher">
                                <span>طفاية حريق / Fire Extinguisher</span>
                            </label>
                        </div>
                        <div class="accessory-item">
                            <label>
                                <input type="checkbox" name="accessories" value="manual">
                                <span>دليل المستخدم / Owner's Manual</span>
                            </label>
                        </div>
                        <div class="accessory-item">
                            <label>
                                <input type="checkbox" name="accessories" value="keys">
                                <span>المفاتيح / Keys</span>
                            </label>
                            <input type="number" name="keysCount" id="keysCount" placeholder="العدد" min="0" max="10" style="width: 80px; margin-right: 10px;">
                        </div>
                        <div class="accessory-item">
                            <label>
                                <input type="checkbox" name="accessories" value="registration">
                                <span>استمارة السيارة / Registration</span>
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: Valuation -->
            <section class="form-section">
                <div class="section-header">
                    <span class="section-number">خامساً</span>
                    <h3>التقييم المالي <span class="en-title">Financial Valuation</span></h3>
                </div>
                <div class="section-content">
                    <div class="valuation-grid valuation-single">
                        <div class="valuation-item">
                            <label>القيمة السوقية التقديرية / Estimated Market Value</label>
                            <div class="currency-input">
                                <input type="number" name="marketValue" id="marketValue" min="0" step="100">
                                <span class="currency">ر.س</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 6: Overall Assessment -->
            <section class="form-section">
                <div class="section-header">
                    <span class="section-number">سادساً</span>
                    <h3>التقييم العام <span class="en-title">Overall Assessment</span></h3>
                </div>
                <div class="section-content">
                    <div class="overall-rating">
                        <label>التقييم الإجمالي للمركبة / Overall Vehicle Rating:</label>
                        <div class="rating-options">
                            <label class="rating-option excellent">
                                <input type="radio" name="overallRating" value="excellent">
                                <span><i class="fas fa-star"></i> ممتاز / Excellent</span>
                            </label>
                            <label class="rating-option good">
                                <input type="radio" name="overallRating" value="good">
                                <span><i class="fas fa-star-half-alt"></i> جيد / Good</span>
                            </label>
                            <label class="rating-option fair">
                                <input type="radio" name="overallRating" value="fair">
                                <span><i class="fas fa-star"></i> مقبول / Fair</span>
                            </label>
                            <label class="rating-option poor">
                                <input type="radio" name="overallRating" value="poor">
                                <span><i class="fas fa-times-circle"></i> ضعيف / Poor</span>
                            </label>
                        </div>
                    </div>
                    <div class="recommendation">
                        <label>التوصية / Recommendation:</label>
                        <div class="recommendation-options">
                            <label>
                                <input type="radio" name="recommendation" value="sell_as_is">
                                <span>البيع كما هي / Sell As-Is</span>
                            </label>
                            <label>
                                <input type="radio" name="recommendation" value="repair_sell">
                                <span>الإصلاح ثم البيع / Repair & Sell</span>
                            </label>
                            <label>
                                <input type="radio" name="recommendation" value="auction">
                                <span>البيع في المزاد / Auction</span>
                            </label>
                            <label>
                                <input type="radio" name="recommendation" value="scrap">
                                <span>التخريد / Scrap</span>
                            </label>
                        </div>
                    </div>
                    <div class="additional-notes">
                        <label>ملاحظات إضافية / Additional Notes:</label>
                        <textarea name="additionalNotes" id="additionalNotes" rows="4"></textarea>
                    </div>
                </div>
            </section>

            <!-- Section 7: Vehicle Photos -->
            <section class="form-section">
                <div class="section-header">
                    <span class="section-number">سابعاً</span>
                    <h3>صور المركبة <span class="en-title">Vehicle Photos</span></h3>
                </div>
                <div class="section-content">
                    <div class="photos-grid">
                        <div class="photo-box">
                            <label>الصورة الأولى / Photo 1</label>
                            <div class="photo-upload" id="photoUpload1" onclick="document.getElementById('photo1').click()">
                                <input type="file" id="photo1" name="photo1" accept="image/*" onchange="previewImage(this, 'preview1')" hidden>
                                <div class="photo-preview" id="preview1">
                                    <i class="fas fa-camera"></i>
                                    <span>اضغط لإضافة صورة</span>
                                </div>
                            </div>
                            <button type="button" class="btn-remove-photo" onclick="removeImage('photo1', 'preview1')" style="display:none;" id="removeBtn1">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                        </div>
                        <div class="photo-box">
                            <label>الصورة الثانية / Photo 2</label>
                            <div class="photo-upload" id="photoUpload2" onclick="document.getElementById('photo2').click()">
                                <input type="file" id="photo2" name="photo2" accept="image/*" onchange="previewImage(this, 'preview2')" hidden>
                                <div class="photo-preview" id="preview2">
                                    <i class="fas fa-camera"></i>
                                    <span>اضغط لإضافة صورة</span>
                                </div>
                            </div>
                            <button type="button" class="btn-remove-photo" onclick="removeImage('photo2', 'preview2')" style="display:none;" id="removeBtn2">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                        </div>
                        <div class="photo-box">
                            <label>الصورة الثالثة / Photo 3</label>
                            <div class="photo-upload" id="photoUpload3" onclick="document.getElementById('photo3').click()">
                                <input type="file" id="photo3" name="photo3" accept="image/*" onchange="previewImage(this, 'preview3')" hidden>
                                <div class="photo-preview" id="preview3">
                                    <i class="fas fa-camera"></i>
                                    <span>اضغط لإضافة صورة</span>
                                </div>
                            </div>
                            <button type="button" class="btn-remove-photo" onclick="removeImage('photo3', 'preview3')" style="display:none;" id="removeBtn3">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 8: Signatures -->
            <section class="form-section signatures-section">
                <div class="section-header">
                    <span class="section-number">ثامناً</span>
                    <h3>التوقيع <span class="en-title">Signature</span></h3>
                </div>
                <div class="section-content">
                    <div class="signatures-grid signatures-single">
                        <div class="signature-box">
                            <label>المقيّم / Evaluator</label>
                            <input type="text" name="evaluatorName" placeholder="الاسم / Name">
                            <input type="text" name="evaluatorId" placeholder="رقم الموظف / Employee ID">
                            <div class="signature-line">
                                <span>التوقيع / Signature</span>
                            </div>
                        </div>
                    </div>
                    <div class="date-stamp">
                        <label>تاريخ التقييم / Evaluation Date:</label>
                        <input type="date" name="evaluationDate" id="evaluationDate">
                    </div>
                </div>
            </section>

            <!-- Action Buttons -->
            <div class="form-actions">
                <button type="button" class="btn btn-primary" onclick="printForm()">
                    <i class="fas fa-print"></i> طباعة / Print
                </button>
                <button type="button" class="btn btn-pdf" onclick="exportToPDF()">
                    <i class="fas fa-file-pdf"></i> تصدير PDF
                </button>
                <button type="button" class="btn btn-excel" onclick="exportToExcel()">
                    <i class="fas fa-file-excel"></i> تصدير Excel
                </button>
                <button type="button" class="btn btn-success" onclick="saveForm()">
                    <i class="fas fa-save"></i> حفظ / Save
                </button>
                <button type="reset" class="btn btn-secondary">
                    <i class="fas fa-redo"></i> مسح / Reset
                </button>
            </div>
        </form>
    </div>

    <script src="js/main.js"></script>
</body>
</html>
